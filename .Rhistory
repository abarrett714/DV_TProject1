setwd("~/DataVisualization/DV_TProject1/01 Data")
require(tidyr)
require(dplyr)
require(ggplot2)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c20151021"
df <- read.csv(file_path, stringsAsFactors = FALSE)
require(tidyr)
require(dplyr)
require(ggplot2)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c20151021.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
head(df)
dplyr::sample_n(df, 10000, replace = TRUE)
df <- sample_n(df, 10000, replace = TRUE)
write.csv(df, paste(gsub(".csv", "", file_path), "10k", sep=""), row.names=FALSE, na = "")
write.csv(df, paste(gsub(".csv", "", file_path), "10k.csv", sep=""), row.names=FALSE, na = "")
require(tidyr)
require(dplyr)
require(ggplot2)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c2015102110k.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
str(df)
measures <- c("BEGIN_YEARMONTH", "BEGIN_DAY", "BEGIN_TIME", "END_YEARMONTH", "END_DAY", "END_TIME", "EPISODE_ID", "EVENT_ID", "STATE_FIPS", "YEAR", "CZ_FIPS", "INJURIES_DIRECT", "INJURIES_INDIRECT", "DEATHS_DIRECT", "DEATHS_INDIRECT", "DAMAGE_PROPERTY", "DAMAGE_CROPS", "MAGNITUDE", "TOR_LENGTH", "TOR_WIDTH", "BEGIN_RANGE", "END_RANGE", "BEGIN_LAT", "BEGIN_LON", "END_LAT", "END_LON")
measures <- c("BEGIN_YEARMONTH", "BEGIN_DAY", "BEGIN_TIME", "END_YEARMONTH", "END_DAY", "END_TIME", "EPISODE_ID", "EVENT_ID", "STATE_FIPS", "YEAR", "CZ_FIPS", "INJURIES_DIRECT", "INJURIES_INDIRECT", "DEATHS_DIRECT", "DEATHS_INDIRECT", "DAMAGE_PROPERTY", "DAMAGE_CROPS", "MAGNITUDE", "TOR_LENGTH", "TOR_WIDTH", "BEGIN_RANGE", "END_RANGE", "BEGIN_LAT", "BEGIN_LON", "END_LAT", "END_LON")
if( length(measures) > 1 || ! is.na(measures)) {
for(m in measures) {
df[m] <- data.frame(lapply(df[m], gsub, pattern="[^--.0-9]",replacement= ""))
}
}
write.csv(df, paste(gsub(".csv", "", file_path), ".reformatted.csv", sep=""), row.names=FALSE, na = "")
dimensions <- setdiff(names(df), measures)
if( length(measures) > 1 || ! is.na(dimensions)) {
for(d in dimensions) {
# Get rid of " and ' in dimensions.
df[d] <- data.frame(lapply(df[d], gsub, pattern="[\"']",replacement= ""))
# Change & to and in dimensions.
df[d] <- data.frame(lapply(df[d], gsub, pattern="&",replacement= " and "))
# Change : to ; in dimensions.
df[d] <- data.frame(lapply(df[d], gsub, pattern=":",replacement= ";"))
}
}
write.csv(df, paste(gsub(".csv", "", file_path), ".reformatted.csv", sep=""), row.names=FALSE, na = "")
tableName <- gsub(" +", "_", gsub("[^A-z, 0-9, ]", "", gsub(".csv", "", file_path)))
sql <- paste("CREATE TABLE", tableName, "(\n-- Change table_name to the table name you want.\n")
if( length(measures) > 1 || ! is.na(dimensions)) {
for(d in dimensions) {
sql <- paste(sql, paste(d, "varchar2(4000),\n"))
}
}
if( length(measures) > 1 || ! is.na(measures)) {
for(m in measures) {
if(m != tail(measures, n=1)) sql <- paste(sql, paste(m, "number(38,4),\n"))
else sql <- paste(sql, paste(m, "number(38,4)\n"))
}
}
sql <- paste(sql, ");")
cat(sql)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c2015102110k.reformatted.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
separate(df, BEGIN_TIME, c("H", "M"))
n = 13
n <- 13
b <- 10
13 % 10
13 %% 10
13 %/% 10
df %>% mutate(., BEGIN_MIN = BEGIN_TIME %% 100)
view(df)
require(tidyr)
require(dplyr)
head(select(df, BEGIN_TIME, BEGIN_MIN))
df <- df %>% mutate(., BEGIN_MIN = BEGIN_TIME %% 100)
df2 <- select(df, BEGIN_TIME, BEGIN_MIN)
head(df2)
df <- read.csv(file_path, stringsAsFactors = FALSE)
df <- df %>% mutate(., BEGIN_MIN = BEGIN_TIME %% 100, BEGIN_HOUR = BEGIN_TIME %/% 100)
df2 <- select(df, BEGIN_TIME, BEGIN_HOUR, BEGIN_MIN)
head(df2)
df2 <- df2 %>% mutate(., BEGIN_MIN = BEGIN_MIN / 60)
head(df2)
df2 <- df2 %>% mutate(., BEGIN_TIME = BEGIN_HOUR + BEGIN_TIME)
head(df2)
df2 <- df2 %>% mutate(., BEGIN_TIME = BEGIN_HOUR + BEGIN_MIN)
head(df2)
df <- read.csv(file_path, stringsAsFactors = FALSE)
df <- df %>% mutate(., BEGIN_MIN = BEGIN_TIME %% 100, BEGIN_HOUR = BEGIN_TIME %/% 100, BEGIN_MIN = BEGIN_MIN / 60, BEGIN_TIME = BEGIN_HOUR + BEGIN_MIN)
head(df2)
Head(select(df, BEGIN_TIME))
head(select(df, BEGIN_TIME))
head(df)
df <- df %>% mutate(., END_MIN = END_TIME %% 100, END_HOUR = END_TIME %/% 100, END_MIN = END_MIN / 60, END_TIME = END_HOUR + END_MIN)
head(select(df, BEGIN_TIME, END_TIME))
library(lubridate)
write.csv(df, paste(gsub(".csv", "", file_path), ".reformatted2.csv", sep=""), row.names=FALSE, na = "")
require(tidyr)
require(dplyr)
library(lubridate)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c2015102110k.reformatted2.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
file_path <- "StormEvents_details-ftp_v1.0_d2015_c2015102110k.reformatted2.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
head(select(df, BEGIN_TIME))
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME)
head(df2)
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME) %>% mutate(., DAMAGE_KPI = (DAMAGE_CROPS+ DAMAGE_PROPERTY) / (END_TIME - BEGIN_TIME))
head(df2)
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME) %>% filter(., DAMAGE_CROPS != 0) %>% mutate(., DAMAGE_KPI = (DAMAGE_CROPS+ DAMAGE_PROPERTY) / (END_TIME - BEGIN_TIME))
head(df2)
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME) %>% filter(., DAMAGE_CROPS != 0 | DAMAGE_PROPERTY != 0) %>% mutate(., DAMAGE_KPI = (DAMAGE_CROPS+ DAMAGE_PROPERTY) / (END_TIME - BEGIN_TIME))
head(df2)
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME) %>% filter(., DAMAGE_CROPS != 0 | DAMAGE_PROPERTY != 0) %>% mutate(., DAMAGE_KPI = (DAMAGE_CROPS+ DAMAGE_PROPERTY) / (END_TIME - BEGIN_TIME)) %>% filter(., DAMAGE_KPI > 0)
head(df2)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Diamonds Crosstab\nSUM_PRICE, SUM_CARAT, SUM_PRICE / SUM_CARAT') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE, label=DAMAGE_KPI),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black"),
position=position_identity()
)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Damage From Natural Disasters') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour=DAMAGE_KPI),
position=position_identity()
)
head(df2)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Damage From Natural Disasters') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE, color = DAMAGE_KPI),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black"),
position=position_identity()
)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Damage From Natural Disasters') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE, color = DAMAGE_KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(colour="black"),
position=position_identity()
)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Damage From Natural Disasters') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE, fill = DAMAGE_KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(),
position=position_identity()
)
df2 <- df %>% select(., EVENT_TYPE, STATE, DAMAGE_CROPS, DAMAGE_PROPERTY, BEGIN_TIME, END_TIME) %>% filter(., DAMAGE_CROPS != 0 | DAMAGE_PROPERTY != 0) %>% mutate(., DAMAGE_KPI = (DAMAGE_CROPS+ DAMAGE_PROPERTY) / (END_TIME - BEGIN_TIME)) %>% filter(., DAMAGE_KPI > 500)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Damage From Natural Disasters') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df2,
mapping=aes(x=EVENT_TYPE, y=STATE, fill = DAMAGE_KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(),
position=position_identity()
)
measures <- c("BEGIN_YEARMONTH", "BEGIN_DAY", "BEGIN_TIME", "END_YEARMONTH", "END_DAY", "END_TIME", "EPISODE_ID", "EVENT_ID", "STATE_FIPS", "YEAR", "CZ_FIPS", "INJURIES_DIRECT", "INJURIES_INDIRECT", "DEATHS_DIRECT", "DEATHS_INDIRECT", "DAMAGE_PROPERTY", "DAMAGE_CROPS", "MAGNITUDE", "TOR_LENGTH", "TOR_WIDTH", "BEGIN_RANGE", "END_RANGE", "BEGIN_LAT", "BEGIN_LON", "END_LAT", "END_LON", "BEGIN_HOUR", "BEGIN_MIN", "END_MIN", "END_HOUR")
dimensions <- setdiff(names(df), measures)
library(lubridate)
require(tidyr)
require(dplyr)
require(ggplot2)
setwd("~/DataVisualization/DV_TProject1/01 Data")
file_path <- "StormEvents_details-ftp_v1.0_d2015_c2015102110k.reformatted2.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)
dimensions <- setdiff(names(df), measures)
tableName <- gsub(" +", "_", gsub("[^A-z, 0-9, ]", "", gsub(".csv", "", file_path)))
sql <- paste("CREATE TABLE", tableName, "(\n-- Change table_name to the table name you want.\n")
if( length(measures) > 1 || ! is.na(dimensions)) {
for(d in dimensions) {
sql <- paste(sql, paste(d, "varchar2(4000),\n"))
}
}
if( length(measures) > 1 || ! is.na(measures)) {
for(m in measures) {
if(m != tail(measures, n=1)) sql <- paste(sql, paste(m, "number(38,4),\n"))
else sql <- paste(sql, paste(m, "number(38,4)\n"))
}
}
sql <- paste(sql, ");")
cat(sql)
