{
    "contents" : "require(tidyr)\nrequire(dplyr)\nrequire(ggplot2)\n\nsetwd(\"~/DataVisualization/DV_TProject1/01 Data\")\n\nfile_path <- \"StormEvents_details-ftp_v1.0_d2015_c2015102110k.csv\"\n\ndf <- read.csv(file_path, stringsAsFactors = FALSE)\n\n#str(df)\n\nmeasures <- c(\"BEGIN_YEARMONTH\", \"BEGIN_DAY\", \"BEGIN_TIME\", \"END_YEARMONTH\", \"END_DAY\", \"END_TIME\", \"EPISODE_ID\", \"EVENT_ID\", \"STATE_FIPS\", \"YEAR\", \"CZ_FIPS\", \"INJURIES_DIRECT\", \"INJURIES_INDIRECT\", \"DEATHS_DIRECT\", \"DEATHS_INDIRECT\", \"DAMAGE_PROPERTY\", \"DAMAGE_CROPS\", \"MAGNITUDE\", \"TOR_LENGTH\", \"TOR_WIDTH\", \"BEGIN_RANGE\", \"END_RANGE\", \"BEGIN_LAT\", \"BEGIN_LON\", \"END_LAT\", \"END_LON\")\n\n# Get rid of special characters in each column.\n# Google ASCII Table to understand the following:\n#for(n in names(df)) {\n#  df[n] <- data.frame(lapply(df[n], gsub, pattern=\"[^ -~]\",replacement= \"\"))\n#}\n\ndimensions <- setdiff(names(df), measures)\nif( length(measures) > 1 || ! is.na(dimensions)) {\n  for(d in dimensions) {\n    # Get rid of \" and ' in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\"[\\\"']\",replacement= \"\"))\n    # Change & to and in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\"&\",replacement= \" and \"))\n    # Change : to ; in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\":\",replacement= \";\"))\n  }\n}\n\nlibrary(lubridate)\n# Fix date columns, this needs to be done by hand because | needs to be correct.\n#                                                        \\_/\n#df$Order_Date <- gsub(\" [0-9]+:.*\", \"\", gsub(\" UTC\", \"\", mdy(as.character(df$Order_Date), tz=\"UTC\")))\n#df$Ship_Date  <- gsub(\" [0-9]+:.*\", \"\", gsub(\" UTC\", \"\", mdy(as.character(df$Ship_Date),  tz=\"UTC\")))\n\n# The following is an example of dealing with special cases like making state abbreviations be all upper case.\n# df[\"State\"] <- data.frame(lapply(df[\"State\"], toupper))\n\n# Get rid of all characters in measures except for numbers, the - sign, and period.dimensions\nif( length(measures) > 1 || ! is.na(measures)) {\n  for(m in measures) {\n    df[m] <- data.frame(lapply(df[m], gsub, pattern=\"[^--.0-9]\",replacement= \"\"))\n  }\n}\n\nwrite.csv(df, paste(gsub(\".csv\", \"\", file_path), \".reformatted.csv\", sep=\"\"), row.names=FALSE, na = \"\")\n\ntableName <- gsub(\" +\", \"_\", gsub(\"[^A-z, 0-9, ]\", \"\", gsub(\".csv\", \"\", file_path)))\nsql <- paste(\"CREATE TABLE\", tableName, \"(\\n-- Change table_name to the table name you want.\\n\")\nif( length(measures) > 1 || ! is.na(dimensions)) {\n  for(d in dimensions) {\n    sql <- paste(sql, paste(d, \"varchar2(4000),\\n\"))\n  }\n}\nif( length(measures) > 1 || ! is.na(measures)) {\n  for(m in measures) {\n    if(m != tail(measures, n=1)) sql <- paste(sql, paste(m, \"number(38,4),\\n\"))\n    else sql <- paste(sql, paste(m, \"number(38,4)\\n\"))\n  }\n}\nsql <- paste(sql, \");\")\ncat(sql)\n",
    "created" : 1446001285126.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3070957238",
    "id" : "CF825881",
    "lastKnownWriteTime" : 1446002571,
    "path" : "~/DataVisualization/DV_TProject1/01 Data/TableCreation.R",
    "project_path" : "01 Data/TableCreation.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}